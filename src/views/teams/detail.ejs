<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
    <%- include('../partials/header') %>

    <main class="app-main">
        <% if (team) { %>
            <section class="page-intro">
                <span class="page-kicker">
                    <i class="bi bi-shield-check"></i>
                    Team Profile
                </span>
                <h1 class="page-title"><%= team.name %></h1>
                <p class="page-subtitle"><%= team.country || 'Country not available' %></p>
            </section>

            <section class="app-card">
                <div class="team-header-card">
                    <% if (team.logo) { %>
                        <div class="team-logo">
                            <img src="<%= team.logo %>" 
                                alt="<%= team.name %>"
                                onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                            <div class="logo-fallback" style="display:none;">
                                <%= team.name.substring(0, 3).toUpperCase() %>
                            </div>
                        </div>
                        <!-- <img src="<%= team.logo %>" alt="<%= team.name %> logo" class="team-logo-lg"> -->
                    <% } %>
                    <div class="team-heading">
                        <h1><%= team.name %></h1>
                        <p>Recent form and league context.</p>
                    </div>
                </div>
                <div class="button-row mt-3">
                    <a href="/analysis?team=<%= team.id %>" class="btn-app">
                        <i class="bi bi-graph-up-arrow"></i>
                        Analyze Team
                    </a>
                    <a href="/teams" class="btn-app btn-app-secondary">
                        <i class="bi bi-arrow-left"></i>
                        Back to Teams
                    </a>
                </div>
            </section>

            <% if (standing) { %>
                <section class="app-card app-card-muted">
                    <div class="section-header">
                        <div>
                            <h2 class="section-title">Current Standing</h2>
                            <p class="section-subtitle"><%= standing.league_name %></p>
                        </div>
                        <span class="pill-counter">
                            <i class="bi bi-trophy"></i>
                            Position <%= standing.position %>
                        </span>
                    </div>
                    <div class="stat-strip">
                        <div class="stat-chip">
                            <p class="stat-label">Points</p>
                            <p class="stat-value"><%= standing.points %></p>
                        </div>
                        <div class="stat-chip">
                            <p class="stat-label">Played</p>
                            <p class="stat-value"><%= standing.played %></p>
                        </div>
                        <div class="stat-chip">
                            <p class="stat-label">Record</p>
                            <p class="stat-value"><%= standing.won %>-<%= standing.drawn %>-<%= standing.lost %></p>
                        </div>
                    </div>
                </section>
            <% } %>

            <section class="app-card">
                <div class="section-header">
                    <div>
                        <h2 class="section-title">Recent Matches</h2>
                        <p class="section-subtitle">Latest finished fixtures for this club.</p>
                    </div>
                    <span class="pill-counter">
                        <i class="bi bi-list-ul"></i>
                        <%= matches ? matches.length : 0 %> matches
                    </span>
                </div>

                <% if (matches && matches.length > 0) { %>
                    <div class="match-list">
                        <% matches.forEach(match => { %>
                            <article class="match-card">
                                <div class="match-head">
                                    <span class="match-date">
                                        <%= new Date(match.match_date).toLocaleDateString('en-US', {
                                            weekday: 'short',
                                            month: 'short',
                                            day: 'numeric',
                                            year: 'numeric'
                                        }) %>
                                    </span>
                                    <span class="status-badge status-finished"><%= match.status %></span>
                                </div>

                                <div class="match-teams">
                                    <span class="team-name <%= match.home_team_id === team.id ? '' : 'muted-text' %>">
                                        <%= match.home_team_name %>
                                    </span>
                                    <span class="score-pill <%= match.result === 'W' ? 'winner' : '' %>">
                                        <%= match.home_score %> - <%= match.away_score %>
                                    </span>
                                    <span class="team-name right <%= match.away_team_id === team.id ? '' : 'muted-text' %>">
                                        <%= match.away_team_name %>
                                    </span>
                                </div>

                                <div class="d-flex justify-content-between mt-2">
                                    <p class="muted-text mb-0">
                                        <i class="bi bi-trophy"></i> <%= match.league_name || 'League' %>
                                    </p>
                                    <span class="pill-counter">
                                        Form: <%= match.result %>
                                    </span>
                                </div>

                                <% if (match.venue) { %>
                                    <p class="muted-text mt-2 mb-0">
                                        <i class="bi bi-geo-alt"></i> <%= match.venue %>
                                    </p>
                                <% } %>
                            </article>
                        <% }); %>
                    </div>
                <% } else { %>
                    <div class="empty-state">
                        <h3>No recent matches found</h3>
                        <p>This team has no finished fixtures in the current dataset.</p>
                    </div>
                <% } %>
            </section>
        <% } else { %>
            <section class="app-card">
                <div class="empty-state">
                    <h2>Team Not Found</h2>
                    <p>The requested team could not be found.</p>
                    <div class="button-row justify-content-center mt-3">
                        <a href="/teams" class="btn-app">
                            <i class="bi bi-people"></i>
                            View Teams
                        </a>
                    </div>
                </div>
            </section>
        <% } %>
    </main>

    <%- include('../partials/footer') %>
</body>
</html>
